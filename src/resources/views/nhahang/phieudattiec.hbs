<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<div class="row">
  <!-- ====menu==== -->
  <div class="menu col l-3 m-0 c-0">

    <ul class="menu-nav l-3 m-0 c-0">
      <img src="/img/logo.png" width="148px">
    </ul>

    <ul class="main">
      <ul class="menu-ul">
        <li class="menu-ul_li">
          <a href="#">
            <i class="ti-home"></i>
            Danh mục


        <li class="menu-ul_li-inside">
        <li class="menu-ul_li-inside_li">
          <a class="menu-ul_li-inside_a" href="">
            <i class="ti-layout-grid2"></i>
            Danh mục phòng
          </a>
        </li>

        <li class="menu-ul_li-inside_li">
          <a class="menu-ul_li-inside_a" href="">
            <i class="ti-receipt"></i>
            Danh mục dịch vụ
          </a>
        </li>

        <li class="menu-ul_li-inside_li">
          <a class="menu-ul_li-inside_a" href="">
            <i class="ti-bookmark-alt"></i>
            Danh mục món ăn
          </a>
        </li>

        <li class="menu-ul_li-inside_li">
          <a class="menu-ul_li-inside_a" href="">
            <i class="ti-microphone-alt"></i>
            Danh mục thiết bị
          </a>
        </li>
        </li>


        </a>
        </li>
        <li class="menu-ul_li">
          <a href="#">
            <i class="ti-user"></i>
            Khách hàng

        <li class="menu-ul_li-inside">
        <li class="menu-ul_li-inside_li">
          <a class="menu-ul_li-inside_a" href="">
            <i class="ti-id-badge"></i>
            Tạo hồ sơ khách hàng
          </a>
        </li>

        <li class="menu-ul_li-inside_li">
          <a class="menu-ul_li-inside_a" href="">
            <i class="ti-cloud-down"></i>
            Cập nhật thông tin
          </a>
        </li>

        </li>

        </a>
        </li>
        <li class="menu-ul_li">
          <a href="#">
            <i class="ti-heart"></i>
            Nhân viên
        <li class="menu-ul_li-inside">
        <li class="menu-ul_li-inside_li">
          <a class="menu-ul_li-inside_a" href="">
            <i class="ti-check-box"></i>
            Tạo hồ sơ nhân viên
          </a>
        </li>

        <li class="menu-ul_li-inside_li">
          <a class="menu-ul_li-inside_a" href="">
            <i class="ti-layers"></i>
            Cập nhật thông tin
          </a>
        </li>

        </li>
        </a>
        </li>
        <li class="menu-ul_li">
          <a href="#">
            <i class="ti-direction"></i>
            Phòng
        <li class="menu-ul_li-inside">
        <li class="menu-ul_li-inside_li">
          <a class="menu-ul_li-inside_a" href="">
            <i class="ti-stamp"></i>
            Đặt phòng
          </a>
        </li>

        <li class="menu-ul_li-inside_li">
          <a class="menu-ul_li-inside_a" href="">
            <i class="ti-layout-media-right"></i>
            Đổi phòng
          </a>
        </li>

        <li class="menu-ul_li-inside_li">
          <a class="menu-ul_li-inside_a" href="">
            <i class="ti-timer"></i>
            Gia hạn phòng
          </a>
        </li>

        <li class="menu-ul_li-inside_li">
          <a class="menu-ul_li-inside_a" href="">
            <i class="ti-notepad"></i>
            Trả Phòng
          </a>
        </li>

        </li>
        </a>
        </li>
        <li class="menu-ul_li">
          <a href="#">
            <i class="ti-clipboard"></i>
            Dịch vụ
        <li class="menu-ul_li-inside">
        <li class="menu-ul_li-inside_li">
          <a class="menu-ul_li-inside_a" href="">
            <i class="ti-layout-grid2"></i>
            Đặt dịch vụ
          </a>
        </li>

        <li class="menu-ul_li-inside_li">
          <a class="menu-ul_li-inside_a" href="">
            <i class="ti-agenda"></i>
            Đặt tiệc
          </a>
        </li>

        </li>
        </a>
        </li>
        <li class="menu-ul_li">
          <a href="#">
            <i class="ti-face-smile"></i>
            Hóa đơn
        <li class="menu-ul_li-inside">
        <li class="menu-ul_li-inside_li">
          <a class="menu-ul_li-inside_a" href="">
            <i class="ti-receipt"></i>
            Thanh toán phòng
          </a>
        </li>

        <li class="menu-ul_li-inside_li">
          <a class="menu-ul_li-inside_a" href="">
            <i class="ti-printer"></i>
            Thanh toán dịch vụ
          </a>
        </li>

        <li class="menu-ul_li-inside_li">
          <a class="menu-ul_li-inside_a" href="">
            <i class="ti-rocket"></i>
            Thanh toán đặt tiệc
          </a>
        </li>

        <li class="menu-ul_li-inside_li">
          <a class="menu-ul_li-inside_a" href="">
            <i class="ti-money"></i>
            Thanh toán sự cố
          </a>
        </li>

        <li class="menu-ul_li-inside_li">
          <a class="menu-ul_li-inside_a" href="">
            <i class="ti-printer"></i>
            Thanh toán tổng
          </a>
        </li>
        </li>
        </a>
        </li>
        <li class="menu-ul_li">
          <a href="#">
            <i class="ti-user"></i>
            Báo biểu

        <li class="menu-ul_li-inside">
        <li class="menu-ul_li-inside_li">
          <a class="menu-ul_li-inside_a" href="">
            <i class="ti-layout-grid2"></i>
            Thống kê khách theo ngày
          </a>
        </li>

        <li class="menu-ul_li-inside_li">
          <a class="menu-ul_li-inside_a" href="">
            <i class="ti-agenda"></i>
            Thống kê khách theo tháng
          </a>
        </li>

        </li>
        </a>
        </li>
      </ul>

    </ul>


  </div>
  <!-- ====menu-end==== -->

  <!-- ====content==== -->
  <div class="menu col l-9 m-12 c-12">
    <nav class="content-nav">

      <ul class="l-3 content-nav_chuong_cachle1">
        <li>GonT</li>
      </ul>

      <ul class="l-8 m-0 c-0 content-nav_chuong_cachle">
        <li class="tro_giup content-nav_chuong">
          <i class="ti-help-alt"></i>
          Trợ Giúp
          <div class="header__notify-giup">
            <header class="header__notify-header-giup">
              <input type="text" placeholder="Nhập thông tin tìm kiếm tại đây">
            </header>
            <ul class="header__notify-list-giup">
              <li class="header__notify-item-giup header__notify-colorbackround-giup">
                <a href="" class="header__notify-link-giup">
                  - Hỗ trợ thiết bị bán hàng
                </a>
              </li>
            </ul>

            <ul class="header__notify-list-giup">
              <li class="header__notify-item-giup header__notify-colorbackround-giup">
                <a href="" class="header__notify-link-giup">
                  - Tài liệu hướng dẫn
                </a>
              </li>
            </ul>

            <ul class="header__notify-list-giup">
              <li class="header__notify-item-giup header__notify-colorbackround-giup">
                <a href="" class="header__notify-link-giup">
                  - Giao diện tổng quan
                </a>
              </li>
            </ul>


            <div class="header__notify-footer">
              <a href="" class="header__notify-footer-btn">
                <i class="fas fa-phone-alt"></i>
                0338091539
              </a>
              <a href="" class="header__notify-footer-btn">
                <i class="fas fa-envelope"></i>
                Gửi hỗ trợ
              </a>
            </div>
          </div>
        </li>
        <li class="js-buy-ticket content-nav_chuong">
          <i class="ti-heart"></i>
          Góp ý
        </li>
        <li class="info content-nav_chuong">

          <img src="/img/img_user.jpg" width="28px">
          NguyenPhucThanh
          <div class="for_info">
            <ul>
              <li>
                <a href="">
                  <i class="fas fa-user-circle"></i>
                  Tài khoản
                </a>
              </li>
              <li class="dich_vu">
                <a href="">
                  <i class="fas fa-concierge-bell"></i>
                  Gói dịch vụ
                </a>
              </li>
              <li>
                <a href="">
                  <i class="ti-book"></i>
                  Điều khoản dịch vụ
                </a>
              </li>
              <li>
                <a href="">
                  <i class="fas fa-shield-alt"></i>
                  Chính sách bảo mật
                </a>
              </li>
              <li>
                <a href="">
                  <i class="fas fa-headset"></i>
                  Hỗ Trợ
                </a>
              </li>
              <li class="dang_xuat">
                <a href="">
                  <i class="fas fa-sign-out-alt"></i>
                  Đăng xuất
                </a>
              </li>
            </ul>
        </li>
        <li class="bell content-nav_chuong">
          <i class="ti-bell"></i>
          <div class="header__notify">
            <header class="header__notify-header">
              <h3>Thông Báo Mới Nhận </h3>
            </header>
            <ul class="header__notify-list">
              <li class="header__notify-item header__notify-colorbackround">
                <a href="" class="header__notify-link">
                  <img src="/img/dichco.jpg" alt="" class="header__notify-img">
                  <div class="header__notify-info">
                    <span class="header__notify-name"> Cai nay là cái tên ở Trên</span>
                    <span class="header__notify-description"> Cai nay là cái tên ở Dưới</span>
                  </div>
                </a>
              </li>
            </ul>

            <ul class="header__notify-list">
              <li class="header__notify-item header__notify-colorbackround">
                <a href="" class="header__notify-link">
                  <img src="/img/dichco.jpg" alt="" class="header__notify-img">
                  <div class="header__notify-info">
                    <span class="header__notify-name"> Cai nay là cái tên ở Trên</span>
                    <span class="header__notify-description"> Cai nay là cái tên ở Dưới </span>
                  </div>
                </a>
              </li>
            </ul>

            <ul class="header__notify-list">
              <li class="header__notify-item   header__notify-colorbackround">
                <a href="" class="header__notify-link">
                  <img src="/img/dichco.jpg" alt="" class="header__notify-img">
                  <div class="header__notify-info">
                    <span class="header__notify-name"> Cai nay là cái tên ở Trên</span>
                    <span class="header__notify-description"> Cai nay là cái tên ở Duoi </span>
                  </div>
                </a>
              </li>
            </ul>

            <div class="header__notify-footer">
              <a href="" class="header__notify-footer-btn">
                Xem tất cả
              </a>
            </div>
          </div>
        </li>
      </ul>


    </nav>





    <!-- ===content__Phieu Dat Tiec==== -->
    <div class="content-container">
      <div class="tieu_de">
        <div class="tieu_de-text">
          Thêm mới phiếu đặt tiệc
        </div>
        <div class="tieu_de-huong-dan">
    
        </div>
      </div>


      <div class="noi_dung-1">
        <div class="l-8 m-12 c-12">
          <div class="bang_lon ">
            <div class="noi_dung-1-text_name">Thông tin cơ bản</div>


            <div class="box">

              <div class="box-trong l-5">
                <div class="noi_dung-1-text_noi-dung">
                  <div class="noi_dung-1-text_noi-dung_hoten">CMND</div>
                  <p> (*)</p>
                </div>
                <input class="textarea" id="cmnd" value="{{data.cmnd}}" placeholder="Nhập số chứng minh"></input>
              </div>

              <div class="box-trong l-5">
                <div class="noi_dung-1-text_noi-dung">
                  <div class="noi_dung-1-text_noi-dung_hoten">SĐT</div>
                  <p> (*)</p>
                </div>
                <input class="textarea" id="phone" value="{{data.phone}}" placeholder="Nhập số SĐT"></input>
              </div>
            </div>
            <div class="noi_dung-1-text_noi-dung">
              <div class="noi_dung-1-text_noi-dung_hoten">Họ tên</div>
              <p> (*)</p>
            </div>
            <input class="textarea" id="name" value="{{data.name}}" placeholder="Nhập họ và tên"></input>





          </div>

          <div class=" bang_lon-dong1 ">
            <div class="noi_dung-1-text_name">Thông tin phiếu</div>


            <table border="1" class="table_ds">
              <thead>
                <tr class="tr_ds">

                  <th scope="col">
                    #
                  </th>
                  <th scope="col">Tên món ăn </th>
                  <th scope="col">Đơn giá</th>
                  <th scope="col">Số lượng</th>
                  <th scope="col">Thành tiền</th>
                </tr>
              </thead>

              <tbody id="tbody"></tbody>
            </table>


            <div class="box-trong l-5">
              <div class="noi_dung-1-text_noi-dung">
                <div class="noi_dung-1-text_noi-dung_hoten">Tổng tiền</div>
                <p> (*)</p>
              </div>

              <div class="box-trong_om">
                <span class="box-trong_text" id="money"> </span>
              </div>
            </div>

          </div>


        </div>
      </div>

      <div class="bottom-nav">
        <button class="bottom-nav_huy">
          Hủy
        </button>

        <button class="bottom-nav_luu" type="button" id="save_btn">
          Lưu
        </button>
      </div>
    </div>



  </div>


  <!-- ===content__Phieu Dat Tiec-end==== -->


</div>
<!-- ====content-end==== -->



</div>

<!-- ===Gop_Y=== -->
<div class="modal js-modal">
  <div class="modal-container js-modal-container">

    <div class="modal-close js-modal-close">
      <i class="ti-close"></i>
    </div>

    <div class="modal-header">
      Gửi góp ý
    </div>

    <div class="modal-body">
      <input id="quantity" type="text" class="modal-input" placeholder="Vui Lòng nhập góp ý của bạn vào đây !">

      <button class=modal-pay>
        Gửi
        <i class="ti-check"></i>
      </button>

      <div class="modal-footer">
        <p class="modal-help">
          Need
          <a href="">
            Help?
          </a>
        </p>
      </div>
    </div>
  </div>

</div>


</div>


</div>
</div>

</div>
<!-- ====content-end==== -->



</div>

<!-- ===Gop_Y=== -->
<div class="modal js-modal">
  <div class="modal-container js-modal-container">

    <div class="modal-close js-modal-close">
      <i class="ti-close"></i>
    </div>

    <div class="modal-header">
      Gửi góp ý
    </div>

    <div class="modal-body">
      <input id="quantity" type="text" class="modal-input" placeholder="Vui Lòng nhập góp ý của bạn vào đây !">

      <button class=modal-pay>
        Gửi
        <i class="ti-check"></i>
      </button>


      <div class="modal-footer">
        <p class="modal-help">
          Need
          <a href="">
            Help?
          </a>
        </p>
      </div>
    </div>
  </div>

</div>

<script>
  // dong/mo Modal
  const buyBtns = document.querySelectorAll('.js-buy-ticket');
  const modal = document.querySelector('.js-modal')
  const modalclose = document.querySelector('.js-modal-close')
  const modalcontainer = document.querySelector('.js-modal-container')

  function Showbuytickets() {
    modal.classList.add('open')
  }
  function hidebuyticket() {
    modal.classList.remove('open')
  }

  for (const buyBtn of buyBtns) {
    buyBtn.addEventListener('click', Showbuytickets)
  }

  modalclose.addEventListener('click', hidebuyticket)
  modal.addEventListener('click', hidebuyticket)
  modalcontainer.addEventListener('click', function (even) {
    even.stopPropagation()
  })
</script>
<!-- action input so luong -->
<script>
   const cmnd = document.getElementById('cmnd').value
   window.localStorage.setItem('key',cmnd)
  if (localStorage.getItem('food') != null) {
    console.log('ready')
  }
  else {
    $.ajax({
      url: 'http://localhost:3000/private/getAllFood',
      type: 'GET',
      success: (data) => {
        localStorage.setItem('food', JSON.stringify(data))
      },
      error: (data) => {
        console.log(data)
      }

    })
    window.location.reload()

  }


  function renderTable(data) {

    $(document).ready(() => {
      let tbody = $('#tbody')

      let str = ''

      let total = 0
      data.forEach((el, index) => {
        total += (data[index]['count'] * data[index]['price'])
        let tr_table =
          `
        <tr class="tr_ds">
     
          <th scope="col">
            ${index + 1}
          </th>
          <th scope="col">${data[index]['name']} </th>
          <th scope="col">${data[index]['price'].toLocaleString('vi', { style: 'currency', currency: 'VND' })}</th>
          <th scope="col"><input value="${data[index]['count']}"  onchange="changeCount('${data[index]['_id']}',event)" min='0' max='15' type='text' ></th>
          <th scope="col">${(data[index]['price'] * data[index]['count']).toLocaleString('vi', { style: 'currency', currency: 'VND' })}</th>
        </tr>
       
       `
        str += tr_table


      })
      $('#money').text(`${total.toLocaleString('vi', { style: 'currency', currency: 'VND' })}`)
      $('#tbody').html(str)
  })




  }
  const data = JSON.parse(localStorage.getItem('food'))
  renderTable(data);

  function changeCount(id, e) {
    const data = JSON.parse(localStorage.getItem('food'))
    data.forEach((el, index) => {
      if (el['_id'] == id) {
        el['count'] = Number(e.target.value)
      }
    })
    localStorage.setItem('food', JSON.stringify(data))
    renderTable(data);
  }



  
</script>
<script>
  $('#save_btn').click(()=>{
   // private/dattiecsearch
    const cmnd = $('#cmnd').val()
    const name = $('#name').val()
    const phone = $('#phone').val()
    const food = JSON.parse(localStorage.getItem('food'))
    let Intomoney = 0
    food.forEach((el,index)=>{
      Intomoney += (el['price'] * el['count'])
    })
    console.log(Intomoney)
    const data ={
      'cmnd': cmnd,
      'name': name,
      'phone': phone,
      'food': food,
      'totalMoney': Intomoney
    }
    $.ajax({
      url:'http://localhost:3000/private/dattiecsearch',
      type: 'POST',
      data: data,
      success:(data)=>{
        console.log(data)
          window.location.href=`http://localhost:3000/private/hddattiec/${cmnd}`
      },
      error:(data)=>{
        console.log(data)
      }
    })   
  })
</script>